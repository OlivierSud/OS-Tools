<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>√âditeur SVG (Supprimer les couleurs)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg:#061c30; --panel:#082137; --panel-2:#051727; --border:#051727;
    --text:#d7dde7; --muted:#9aa5b1; --accent1:#4f8cff; --accent2:#7a5cff;
    --accent3:#4fff95; --accent4:#5cff85;
  }
  html,body{height:100%; margin:0;}
  body{
    display:flex; flex-direction:column; height:100vh; background:var(--bg); color:var(--text);
    font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  /* Barre sup√©rieure */
  #topbar{
    display:flex; gap:10px; align-items:center; padding:12px;
    background:linear-gradient(90deg, #242c3b, #1c1f25); border-bottom:1px solid var(--border);
  }
  .btn{
    border:0; padding:10px 16px; border-radius:10px; color:#fff; font-weight:700; cursor:pointer;
    background:linear-gradient(135deg, var(--accent1), var(--accent2));
    box-shadow:0 6px 16px rgba(79,140,255,.18);
    transition:transform .12s ease, filter .15s ease; display:inline-block;
  }
  .btn:hover{ transform:translateY(-2px); background:linear-gradient(135deg, var(--accent3), var(--accent4)); color:#011b0a; }
  .btn:active{ transform:translateY(2px); }

  /* Zone principale */
  .viewer{ flex:1; display:flex; overflow:hidden; }
  .panel{ flex:1; display:flex; flex-direction:column; border-right:1px solid var(--border); background:var(--panel); }
  .panel:last-child{ border-right:none; }
  .panel header{ padding:10px; border-bottom:1px solid var(--border); font-weight:700; color:var(--text); background:var(--panel-2); }
  .svg-container{ flex:1; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#0e1426; }
  .svg-container svg{ max-width:100%; max-height:100%; width:auto; height:auto; display:block; }
  .muted{ color:var(--muted); }

  /* Liste des couleurs */
  #colorsList{
    background:#0e1426; border-top:1px solid var(--border); padding:10px; display:flex; flex-wrap:wrap; gap:10px; min-height:60px;
  }
  .color-item{
    display:flex; align-items:center; gap:6px; padding:4px 8px; border:1px solid rgba(255,255,255,.15);
    border-radius:6px; font-size:13px; color:#e6e9f2; background:#0f1a31;
  }
  .color-sample{ width:16px; height:16px; border-radius:3px; border:1px solid rgba(255,255,255,.25); }
</style>
</head>
<body>

  <!-- Barre menu en haut -->
  <div id="topbar">
    <input type="file" id="fileInput" accept=".svg" hidden />
    <label for="fileInput" class="btn">‚¨áÔ∏è Importer SVG</label>
    <button class="btn" id="clearColorsBtn" disabled>üé® Effacer couleurs</button>
    <button class="btn" id="exportBtn" disabled>üíæ Exporter SVG</button>
  </div>

  <!-- Zone de visualisation -->
  <div class="viewer">
    <div class="panel">
      <header>SVG Original</header>
      <div id="original" class="svg-container">
        <p class="muted">Aucun SVG charg√©.</p>
      </div>
    </div>
    <div class="panel">
      <header>SVG Modifi√©</header>
      <div id="modified" class="svg-container">
        <p class="muted">SVG modifi√© affich√© ici.</p>
      </div>
    </div>
  </div>

  <!-- Liste des couleurs toujours en bas -->
  <div id="colorsList"><span class="muted">Aucune couleur d√©tect√©e.</span></div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const originalDiv = document.getElementById('original');
    const modifiedDiv = document.getElementById('modified');
    const clearColorsBtn = document.getElementById('clearColorsBtn');
    const exportBtn = document.getElementById('exportBtn');
    const colorsList = document.getElementById('colorsList');

    let svgDoc = null;
    let modifiedDoc = null;

    // Extraire les couleurs du SVG
    function extractColors(svgElement){
      const colors = new Set();
      svgElement.querySelectorAll('*').forEach(el=>{
        let f = el.getAttribute('fill');
        let s = el.getAttribute('stroke');
        if(f && f !== "none") colors.add(f);
        if(s && s !== "none") colors.add(s);
        const style = el.getAttribute('style');
        if(style){
          style.split(';').forEach(rule=>{
            const [prop,val] = rule.split(':').map(x=>x && x.trim());
            if(prop==="fill" && val && val!=="none") colors.add(val);
            if(prop==="stroke" && val && val!=="none") colors.add(val);
          });
        }
      });
      return Array.from(colors);
    }

    // Afficher liste des couleurs
    function renderColorsList(colors){
      colorsList.innerHTML = "";
      if(colors.length === 0){
        colorsList.innerHTML = "<span class='muted'>Aucune couleur d√©tect√©e.</span>";
        return;
      }
      colors.forEach(c=>{
        const item = document.createElement("div");
        item.className = "color-item";
        const swatch = document.createElement("div");
        swatch.className = "color-sample";
        swatch.style.background = c;
        item.appendChild(swatch);
        const label = document.createElement("span");
        label.textContent = c;
        item.appendChild(label);
        colorsList.appendChild(item);
      });
    }

    // Import SVG
    fileInput.addEventListener('change', function (event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function (e) {
        const text = e.target.result;
        const parser = new DOMParser();
        svgDoc = parser.parseFromString(text, "image/svg+xml").documentElement;
        originalDiv.innerHTML = "";
        originalDiv.appendChild(svgDoc.cloneNode(true));
        modifiedDiv.innerHTML = "<p class='muted'>Cliquez sur Effacer couleurs.</p>";
        clearColorsBtn.disabled = false;
        exportBtn.disabled = true;

        renderColorsList(extractColors(svgDoc));
      };
      reader.readAsText(file);
    });

    // Effacer couleurs
    clearColorsBtn.addEventListener('click', function () {
      if (!svgDoc) return;
      modifiedDoc = svgDoc.cloneNode(true);
      modifiedDoc.querySelectorAll('*').forEach(el => {
        el.removeAttribute('fill');
        el.removeAttribute('stroke');
        el.removeAttribute('style');
      });
      modifiedDiv.innerHTML = "";
      modifiedDiv.appendChild(modifiedDoc);
      exportBtn.disabled = false;
    });

    // Exporter SVG
    exportBtn.addEventListener('click', function () {
      if (!modifiedDoc) return;
      const serializer = new XMLSerializer();
      const svgString = serializer.serializeToString(modifiedDoc);
      const blob = new Blob([svgString], { type: "image/svg+xml" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "svg_sans_couleurs.svg";
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
